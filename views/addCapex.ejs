<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Add Capex</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <h1>Add Capex for Company ID: <%= companyId %>, Case ID: <%= caseId %></h1>
    <nav>
      <a href="/">Home</a>
      <a href="/logout">Logout</a>
      <div class="dropdown">
        <button class="dropbtn">Account</button>
        <div class="dropdown-content">
          <a href="#">User: <%= user.username %></a>
        </div>
      </div>
    </nav>
    <form action="/addCapex/<%= companyId %>/<%= caseId %>" method="POST">
      <input type="text" name="item" placeholder="Item" required />
      <input
        type="number"
        name="rate"
        placeholder="Rate"
        min="0"
        step="0.01"
        required
      />
      <input
        type="number"
        name="quantity"
        placeholder="Quantity"
        min="1"
        required
      />
      <button type="submit">Add Capex</button>
    </form>
    <% if (capex.length > 0) { %>
    <table>
      <thead>
        <tr>
          <th>Item</th>
          <th>Rate</th>
          <th>Quantity</th>
          <th>Year 1</th>
          <th>Year 2</th>
          <th>Year 3</th>
          <th>Year 4</th>
          <th>Year 5</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% capex.forEach(function(item) { %>
        <tr>
          <td><%= item.item %></td>
          <td><%= item.rate %></td>
          <td><%= item.quantity %></td>
          <td><%= item.rate * item.quantity %></td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>
            <a
              href="/editCapex/<%= item.id %>?companyId=<%= companyId %>&caseId=<%= caseId %>"
              >Edit</a
            >
            <a
              href="/deleteCapex/<%= item.id %>?companyId=<%= companyId %>&caseId=<%= caseId %>"
              >Delete</a
            >
          </td>
        </tr>
        <% }); %>
        <tr>
          <td>Capex Total</td>
          <td></td>
          <td></td>
          <td>
            <%= capex.reduce((acc, item) => acc + (item.rate * item.quantity),
            0) %>
          </td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td></td>
        </tr>
      </tbody>
    </table>
    <% } %>
  </body>
</html>
